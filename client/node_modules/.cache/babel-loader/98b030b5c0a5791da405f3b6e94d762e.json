{"ast":null,"code":"import _classCallCheck from \"/Users/brianmacpherson/Desktop/cantotalkweb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/brianmacpherson/Desktop/cantotalkweb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/brianmacpherson/Desktop/cantotalkweb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/brianmacpherson/Desktop/cantotalkweb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/brianmacpherson/Desktop/cantotalkweb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/brianmacpherson/Desktop/cantotalkweb/src/Components/EntryView/EntryView.js\";\nimport React, { Component } from 'react';\nimport './EntryView.css';\nimport { connect } from 'react-redux';\nimport { push } from 'connected-react-router';\nimport { optionAlert } from '../../Containers/OptionAlert/OptionAlert';\nimport { validateUser, serverError } from '../../Helpers/helpers';\nimport Icon from '../Icon/Icon';\nimport { setPrevRoute as _setPrevRoute } from '../../Routing/actions';\nimport { setLoading as _setLoading } from '../../Loading/actions';\nimport { setMobileEntry as _setMobileEntry } from '../../Containers/Search/actions';\nimport { routes } from '../../Routing/constants';\nimport apiRequest from '../../Helpers/apiRequest';\nimport { audioRequest, setupPlayBack } from '../../Helpers/audioRequest';\nimport { isIOS } from \"react-device-detect\";\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    userID: state.user.user.userID,\n    pathName: state.router.location.pathname,\n    hash: state.router.location.hash\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    updateURL: function updateURL(path) {\n      return dispatch(push(path));\n    },\n    setPrevRoute: function setPrevRoute(prevRoute) {\n      return dispatch(_setPrevRoute(prevRoute));\n    },\n    setLoading: function setLoading(loading) {\n      return dispatch(_setLoading(loading));\n    },\n    setMobileEntry: function setMobileEntry(entryID) {\n      return dispatch(_setMobileEntry(entryID));\n    }\n  };\n};\n\nvar EntryView =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(EntryView, _Component);\n\n  function EntryView(props) {\n    var _this;\n\n    _classCallCheck(this, EntryView);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(EntryView).call(this, props));\n\n    _this.getEntry = function (hash) {\n      var _this$props = _this.props,\n          userID = _this$props.userID,\n          setLoading = _this$props.setLoading;\n      var entryID = hash.slice(1, hash.length);\n      setLoading(true);\n\n      _this.loadAudio(entryID);\n\n      if (entryID != null && validateUser(userID)) {\n        _this.checkIfFavorite(entryID, userID);\n      }\n\n      apiRequest({\n        endPoint: '/entryid',\n        method: 'POST',\n        body: {\n          entryID: entryID\n        }\n      }).then(function (entry) {\n        setLoading(false);\n\n        if (entry.error) {\n          serverError();\n        } else {\n          _this._isMounted && _this.setState({\n            entry: entry\n          });\n        }\n      }).catch(function () {\n        setLoading(false);\n        serverError();\n      });\n    };\n\n    _this.checkIfFavorite = function (entryID, userID) {\n      var setLoading = _this.props.setLoading;\n      var isFavorited = _this.state.isFavorited;\n      setLoading(true);\n      apiRequest({\n        endPoint: '/favorites/isFavorited',\n        method: 'POST',\n        body: {\n          entryID: entryID,\n          userID: userID\n        }\n      }).then(function (favorited) {\n        setLoading(false);\n\n        if (favorited !== isFavorited) {\n          _this._isMounted && _this.setState({\n            isFavorited: favorited\n          });\n        }\n      }).catch(function () {\n        return setLoading(false);\n      });\n    };\n\n    _this.toggleFavorite = function (entryID, userID, cantoWord) {\n      var _this$props2 = _this.props,\n          updateFavs = _this$props2.updateFavs,\n          updateURL = _this$props2.updateURL,\n          pathName = _this$props2.pathName,\n          setPrevRoute = _this$props2.setPrevRoute,\n          setLoading = _this$props2.setLoading;\n      var LOGIN = routes.LOGIN,\n          FAVORITES = routes.FAVORITES;\n\n      if (validateUser(userID)) {\n        setLoading(true);\n        apiRequest({\n          endPoint: '/favorites/toggle',\n          method: 'POST',\n          body: {\n            entryID: entryID,\n            userID: userID,\n            cantoWord: cantoWord\n          }\n        }).then(function (favorited) {\n          setLoading(false);\n\n          if (favorited.error) {\n            serverError();\n          } else {\n            _this._isMounted && _this.setState({\n              isFavorited: favorited\n            });\n\n            if (pathName === FAVORITES) {\n              updateFavs(userID, FAVORITES);\n\n              if (!favorited) {\n                updateURL(pathName);\n              }\n            }\n          }\n        }).catch(function () {\n          setLoading(false);\n          serverError();\n        });\n      } else {\n        optionAlert({\n          title: 'Please sign in.',\n          message: 'You must be signed in to save favorites. Would you like to sign in or register now?',\n          buttons: [{\n            label: 'Yes',\n            onClick: function onClick() {\n              setPrevRoute(pathName);\n              updateURL(LOGIN);\n            }\n          }, {\n            label: 'No',\n            onClick: null\n          }]\n        });\n      }\n    };\n\n    _this.loadAudio = function (entryID) {\n      if (isIOS && _this.playButton.current) {\n        _this.playButton.current.removeEventListener('touchstart', _this.unlockAudio, false);\n      }\n\n      if (_this.playButton.current) {\n        var setLoading = _this.props.setLoading;\n        setLoading(true);\n        audioRequest(entryID).then(function (_ref) {\n          var context = _ref.context,\n              arrayBuffer = _ref.arrayBuffer;\n          context.decodeAudioData(arrayBuffer, function (decodedAudio) {\n            _this.setState({\n              audioAvailable: true,\n              context: context,\n              decodedAudio: decodedAudio\n            });\n\n            if (isIOS) {\n              _this.playButton.current.addEventListener('touchstart', _this.unlockAudio, false);\n            }\n\n            setLoading(false);\n          }, function () {\n            return _this.noAudio();\n          });\n        }).catch(function () {\n          return _this.noAudio();\n        });\n      }\n    };\n\n    _this.playAudio = function () {\n      if (!isIOS) {\n        _this.unlockAudio();\n      }\n    };\n\n    _this.unlockAudio = function () {\n      var _this$state = _this.state,\n          context = _this$state.context,\n          decodedAudio = _this$state.decodedAudio,\n          audioAvailable = _this$state.audioAvailable;\n\n      if (audioAvailable) {\n        var playSound = setupPlayBack(context, decodedAudio);\n        playSound.start(0);\n      }\n    };\n\n    _this.noAudio = function () {\n      var setLoading = _this.props.setLoading;\n\n      _this.setState({\n        audioAvailable: false\n      });\n\n      setLoading(false);\n    };\n\n    _this.playButton = React.createRef();\n    _this._isMounted = false;\n    _this.state = {\n      isFavorited: false,\n      entry: '',\n      audioAvailable: false,\n      context: {},\n      decodedAudio: {}\n    };\n    return _this;\n  }\n\n  _createClass(EntryView, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this._isMounted = true;\n      var hash = this.props.hash;\n\n      if (hash) {\n        this.getEntry(hash);\n      }\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      var _this$props3 = this.props,\n          selectedEntry = _this$props3.selectedEntry,\n          userID = _this$props3.userID,\n          hash = _this$props3.hash,\n          setMobileEntry = _this$props3.setMobileEntry,\n          pathName = _this$props3.pathName;\n      var entry = this.state.entry;\n      var WORD_OF_THE_DAY = routes.WORD_OF_THE_DAY,\n          FAVORITES = routes.FAVORITES;\n\n      if (prevProps.selectedEntry !== selectedEntry) {\n        this.setState({\n          entry: selectedEntry\n        });\n        this.loadAudio(selectedEntry.entry_id);\n\n        if (pathName === FAVORITES) {\n          this.setState({\n            isFavorited: true\n          });\n        } else if (selectedEntry !== '' && validateUser(userID)) {\n          this.setState({\n            isFavorited: false\n          });\n          this.checkIfFavorite(selectedEntry.entry_id, userID);\n        }\n      } else if (hash && hash !== prevProps.hash) {\n        this.getEntry(hash);\n      } else if (pathName !== WORD_OF_THE_DAY && !hash && entry !== '') {\n        this.setState({\n          entry: ''\n        });\n        setMobileEntry('');\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this._isMounted = false;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var WORD_OF_THE_DAY = routes.WORD_OF_THE_DAY;\n      var _this$props4 = this.props,\n          userID = _this$props4.userID,\n          pathName = _this$props4.pathName;\n      var _this$state2 = this.state,\n          isFavorited = _this$state2.isFavorited,\n          entry = _this$state2.entry,\n          _this$state2$entry = _this$state2.entry,\n          entry_id = _this$state2$entry.entry_id,\n          canto_word = _this$state2$entry.canto_word,\n          classifier = _this$state2$entry.classifier,\n          jyutping = _this$state2$entry.jyutping,\n          english_word = _this$state2$entry.english_word,\n          mandarin_word = _this$state2$entry.mandarin_word,\n          canto_sentence = _this$state2$entry.canto_sentence,\n          jyutping_sentence = _this$state2$entry.jyutping_sentence,\n          english_sentence = _this$state2$entry.english_sentence,\n          audioAvailable = _this$state2.audioAvailable;\n      var clLabel = classifier ? 'cl: ' : '';\n      var isWOD = pathName === WORD_OF_THE_DAY;\n      var active = audioAvailable ? 'entry-btn-active' : 'entry-btn-disabled';\n      return React.createElement(\"div\", {\n        className: \"entry-view \".concat(isWOD ? 'wod-view' : 'non-wod-view'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 252\n        },\n        __self: this\n      }, entry !== '' ? React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 254\n        },\n        __self: this\n      }, isWOD && React.createElement(\"div\", {\n        className: \"center-div\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 256\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        className: \"wod-date\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 257\n        },\n        __self: this\n      }, new Date(entry.date).toLocaleDateString('en-US', {\n        weekday: 'long',\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric'\n      }))), React.createElement(\"div\", {\n        className: \"inner-entry-view\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 261\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"entry-btn-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 263\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        className: \"entry-btn entry-btn-active\",\n        onClick: function onClick() {\n          return _this2.toggleFavorite(entry_id, userID, canto_word);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 264\n        },\n        __self: this\n      }, isFavorited ? React.createElement(Icon, {\n        icon: \"like-2-full\",\n        iconSize: \"35\",\n        color: \"cantoPink\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 269\n        },\n        __self: this\n      }) : React.createElement(Icon, {\n        icon: \"like-2\",\n        iconSize: \"35\",\n        color: \"cantoDarkBlue\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 274\n        },\n        __self: this\n      })), React.createElement(\"button\", {\n        className: \"entry-btn \".concat(active),\n        onClick: this.playAudio,\n        ref: this.playButton,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 281\n        },\n        __self: this\n      }, React.createElement(Icon, {\n        icon: \"speaker-5\",\n        iconSize: \"35\",\n        color: audioAvailable ? 'cantoDarkBlue' : 'cantoDarkGray',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 286\n        },\n        __self: this\n      }))), React.createElement(\"div\", {\n        className: \"top-group entry-section\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 296\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"canto-class\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 297\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 298\n        },\n        __self: this\n      }, canto_word), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 299\n        },\n        __self: this\n      }, clLabel, classifier)), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 301\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 301\n        },\n        __self: this\n      }, jyutping))), React.createElement(\"div\", {\n        className: \"entry-section\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 303\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 304\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 304\n        },\n        __self: this\n      }, \"En: \", english_word)), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 305\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 305\n        },\n        __self: this\n      }, \"\\u666E: \", mandarin_word))), React.createElement(\"div\", {\n        className: \"entry-section\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 307\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 308\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 308\n        },\n        __self: this\n      }, canto_sentence)), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 309\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 309\n        },\n        __self: this\n      }, jyutping_sentence)), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 310\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 310\n        },\n        __self: this\n      }, english_sentence))))) : React.createElement(\"div\", {\n        className: \"inner-entry-view\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 314\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"entry-btn-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 315\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"ghost-div\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 316\n        },\n        __self: this\n      }, \"\\xA0\"), React.createElement(\"div\", {\n        className: \"ghost-div\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 317\n        },\n        __self: this\n      }, \"\\xA0\")), React.createElement(\"div\", {\n        className: \"top-group entry-section\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 319\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"canto-class\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 320\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"ghost-div\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 321\n        },\n        __self: this\n      }, \"\\xA0\"), React.createElement(\"div\", {\n        className: \"ghost-div\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 322\n        },\n        __self: this\n      }, \"\\xA0\")), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 324\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"ghost-div\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 325\n        },\n        __self: this\n      }, \"\\xA0\"))), React.createElement(\"div\", {\n        className: \"entry-section\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 328\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"ghost-div\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 329\n        },\n        __self: this\n      }, \"\\xA0\"), React.createElement(\"div\", {\n        className: \"ghost-div\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 330\n        },\n        __self: this\n      }, \"\\xA0\")), React.createElement(\"div\", {\n        className: \"entry-section\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 332\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"ghost-div\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 333\n        },\n        __self: this\n      }, \"\\xA0\"), React.createElement(\"div\", {\n        className: \"ghost-div\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 334\n        },\n        __self: this\n      }, \"\\xA0\"), React.createElement(\"div\", {\n        className: \"ghost-div\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 335\n        },\n        __self: this\n      }, \"\\xA0\"))));\n    }\n  }]);\n\n  return EntryView;\n}(Component);\n\nexport default connect(mapStateToProps, mapDispatchToProps)(EntryView);","map":{"version":3,"sources":["/Users/brianmacpherson/Desktop/cantotalkweb/src/Components/EntryView/EntryView.js"],"names":["React","Component","connect","push","optionAlert","validateUser","serverError","Icon","setPrevRoute","setLoading","setMobileEntry","routes","apiRequest","audioRequest","setupPlayBack","isIOS","mapStateToProps","state","userID","user","pathName","router","location","pathname","hash","mapDispatchToProps","dispatch","updateURL","path","prevRoute","loading","entryID","EntryView","props","getEntry","slice","length","loadAudio","checkIfFavorite","endPoint","method","body","then","entry","error","_isMounted","setState","catch","isFavorited","favorited","toggleFavorite","cantoWord","updateFavs","LOGIN","FAVORITES","title","message","buttons","label","onClick","playButton","current","removeEventListener","unlockAudio","context","arrayBuffer","decodeAudioData","decodedAudio","audioAvailable","addEventListener","noAudio","playAudio","playSound","start","createRef","prevProps","selectedEntry","WORD_OF_THE_DAY","entry_id","canto_word","classifier","jyutping","english_word","mandarin_word","canto_sentence","jyutping_sentence","english_sentence","clLabel","isWOD","active","Date","date","toLocaleDateString","weekday","year","month","day"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport './EntryView.css';\nimport { connect } from 'react-redux';\nimport { push } from 'connected-react-router';\nimport { optionAlert } from '../../Containers/OptionAlert/OptionAlert';\nimport { validateUser, serverError } from '../../Helpers/helpers';\nimport Icon from '../Icon/Icon';\nimport { setPrevRoute } from '../../Routing/actions';\nimport { setLoading } from '../../Loading/actions';\nimport { setMobileEntry } from '../../Containers/Search/actions';\nimport { routes } from '../../Routing/constants';\nimport apiRequest from '../../Helpers/apiRequest';\nimport { audioRequest, setupPlayBack } from '../../Helpers/audioRequest';\nimport { isIOS } from \"react-device-detect\";\n\nconst mapStateToProps = state => {\n\treturn {\n\t\tuserID: state.user.user.userID,\n\t\tpathName: state.router.location.pathname,\n\t\thash: state.router.location.hash,\n\t}\n}\n\nconst mapDispatchToProps = (dispatch) => {\n\treturn {\n\t\tupdateURL: (path) => dispatch(push(path)),\n\t\tsetPrevRoute: (prevRoute) => dispatch(setPrevRoute(prevRoute)),\n\t\tsetLoading: (loading) => dispatch(setLoading(loading)),\n\t\tsetMobileEntry: (entryID) => dispatch(setMobileEntry(entryID)),\n\t}\n}\n\nclass EntryView extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.playButton = React.createRef();\n\t\tthis._isMounted = false;\n\t\tthis.state = {\n\t\t\tisFavorited: false,\n\t\t\tentry: '',\n\t\t\taudioAvailable: false,\n\t\t\tcontext: {},\n\t\t\tdecodedAudio: {}\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tthis._isMounted = true;\n\t\tconst { hash } = this.props;\n\t\tif (hash) {\n\t\t\tthis.getEntry(hash)\n\t\t}\n\t}\n\n\tcomponentDidUpdate(prevProps) {\n\t\tconst { selectedEntry, userID, hash, setMobileEntry, pathName } = this.props;\n\t\tconst { entry } = this.state;\n\t\tconst { WORD_OF_THE_DAY, FAVORITES } = routes;\n\t\tif (prevProps.selectedEntry !== selectedEntry) {\n\t\t\tthis.setState({entry: selectedEntry})\n\t\t\tthis.loadAudio(selectedEntry.entry_id)\n\t\t\tif (pathName === FAVORITES) {\n\t\t\t\tthis.setState({isFavorited: true})\n\t\t\t} else if (selectedEntry !== '' && validateUser(userID)) {\n\t\t\t\tthis.setState({isFavorited: false})\n\t\t\t\tthis.checkIfFavorite(selectedEntry.entry_id, userID);\n\t\t\t}\n\t\t} else if (hash && hash !== prevProps.hash) {\n\t\t\tthis.getEntry(hash)\n\t\t} else if (pathName !== WORD_OF_THE_DAY && !hash && entry !== '') {\n\t\t\tthis.setState({entry: ''})\n\t\t\tsetMobileEntry('');\n\t\t} \n\t}\n\n\tcomponentWillUnmount() {\n\t\tthis._isMounted = false;\n\t}\n\n\tgetEntry = (hash) => {\n\t\tconst { userID, setLoading } = this.props;\n\t\tconst entryID = hash.slice(1, hash.length)\n\t\tsetLoading(true)\n\t\tthis.loadAudio(entryID)\n\t\tif (entryID != null && validateUser(userID)) {\n\t\t\tthis.checkIfFavorite(entryID, userID);\n\t\t}\n\n\t\tapiRequest({\n\t\t\tendPoint: '/entryid',\n\t\t\tmethod: 'POST',\n\t\t\tbody: {entryID} \n\t\t})\n\t\t.then(entry => {\n\t\t\tsetLoading(false)\n\t\t\tif (entry.error) {\n\t\t\t\tserverError()\n\t\t\t} else {\n\t\t\t\tthis._isMounted && this.setState({entry})\n\t\t\t}\n\t\t})\n\t\t.catch(() => {\n\t\t\tsetLoading(false)\n\t\t\tserverError()\n\t\t})\n\t}\n\n\tcheckIfFavorite = (entryID, userID) => {\n\t\tconst { setLoading } = this.props;\n\t\tconst { isFavorited } = this.state;\n\t\tsetLoading(true)\n\t\tapiRequest({\n\t\t\tendPoint: '/favorites/isFavorited',\n\t\t\tmethod: 'POST',\n\t\t\tbody: {entryID, userID} \n\t\t})\n\t\t.then(favorited => {\n\t\t\tsetLoading(false)\n\t\t\tif (favorited !== isFavorited) {\n\t\t\t\tthis._isMounted && this.setState({isFavorited: favorited})\n\t\t\t}\n\t\t})\n\t\t.catch(()=>setLoading(false))\n\t}\n\n\ttoggleFavorite = (entryID, userID, cantoWord) => {\n\t\tconst { \n\t\t\tupdateFavs,\n\t\t\tupdateURL,\n\t\t\tpathName,\n\t\t\tsetPrevRoute,\n\t\t\tsetLoading,\n\t\t} = this.props;\n\t\tconst { LOGIN, FAVORITES } = routes;\n\t\tif (validateUser(userID)) {\n\t\t\tsetLoading(true)\n\t\t\tapiRequest({\n\t\t\t\tendPoint: '/favorites/toggle',\n\t\t\t\tmethod: 'POST',\n\t\t\t\tbody: {entryID, userID, cantoWord} \n\t\t\t})\n\t\t\t.then(favorited => {\n\t\t\t\tsetLoading(false)\n\t\t\t\tif (favorited.error) {\n\t\t\t\t\tserverError()\n\t\t\t\t} else {\n\t\t\t\t\tthis._isMounted && this.setState({isFavorited: favorited})\n\t\t\t\t\tif (pathName === FAVORITES) {\n\t\t\t\t\t\tupdateFavs(userID, FAVORITES)\n\t\t\t\t\t\tif (!favorited) {\n\t\t\t\t\t\t\tupdateURL(pathName)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(() => {\n\t\t\t\tsetLoading(false)\n\t\t\t\tserverError()\n\t\t\t})\n\t\t} else {\n\t\t\toptionAlert({\n\t\t\t    title: 'Please sign in.',\n\t\t\t    message: 'You must be signed in to save favorites. Would you like to sign in or register now?',\n\t\t\t    buttons: [\n\t\t\t      {\n\t\t\t        label: 'Yes',\n\t\t\t        onClick: () => {\n\t\t\t        \tsetPrevRoute(pathName)\n\t\t\t        \tupdateURL(LOGIN)\n\t\t\t        }\n\t\t\t      },\n\t\t\t      {\n\t\t\t        label: 'No',\n\t\t\t        onClick: null\n\t\t\t      }\n\t\t\t    ]\n\t\t    })\n\t\t}\n\t}\n\n\tloadAudio = (entryID) => {\n\t\tif (isIOS && this.playButton.current) {     \n\t\t\tthis.playButton.current.removeEventListener('touchstart', this.unlockAudio, false)\n\t\t}\n\n\t\tif (this.playButton.current) {\n\t\t\tconst { setLoading} = this.props;\n\t\t\tsetLoading(true)\n\t\t\taudioRequest(entryID)\n\t\t        .then(({context, arrayBuffer}) => {\n\t        \t\tcontext.decodeAudioData(arrayBuffer, decodedAudio => {\n\t    \t\t\t\tthis.setState({\n\t\t\t            \taudioAvailable: true,\n\t\t\t            \tcontext, \n\t\t\t            \tdecodedAudio\n\t\t\t            })\n\t\t\t            if (isIOS) {\n\t\t\t             \tthis.playButton.current.addEventListener('touchstart', this.unlockAudio, false);\n\t\t\t            }\n\t\t\t            setLoading(false)\n\t\t\t        }, ()=>this.noAudio())\n\t\t        })\n\t\t        .catch(()=>this.noAudio())\n\t\t}\n\t}\n\n\tplayAudio = () => {\n\t\tif (!isIOS) {\n\t\t\tthis.unlockAudio()\n\t\t}\n\t}\n\n\tunlockAudio = () => {\n\t\tconst { context, decodedAudio, audioAvailable } = this.state;\n\t\tif (audioAvailable) {\n\t\t\tconst playSound = setupPlayBack(context, decodedAudio)\n\t        playSound.start(0);\n\t\t}\n\t}\n\n\tnoAudio = () => {\n\t\tconst { setLoading} = this.props;\n\t\tthis.setState({audioAvailable: false})\n\t\tsetLoading(false)\n\t}\n\n\trender() {\n\t\tconst { WORD_OF_THE_DAY } = routes;\n\t\tconst { userID, pathName } = this.props;\n\t\tconst {\n\t\t\tisFavorited,\n\t\t\tentry,\n\t\t\tentry: {\n\t\t\t\tentry_id,\n\t\t\t\tcanto_word,\n\t\t\t\tclassifier,\n\t\t\t\tjyutping,\n\t\t\t\tenglish_word,\n\t\t\t\tmandarin_word,\n\t\t\t\tcanto_sentence,\n\t\t\t\tjyutping_sentence,\n\t\t\t\tenglish_sentence\n\t\t\t},\n\t\t\taudioAvailable\n\t\t} = this.state\n\n\t\tconst clLabel = classifier ? 'cl: ' : '';\n\t\tconst isWOD = (pathName === WORD_OF_THE_DAY)\n\t\tconst active = audioAvailable ? 'entry-btn-active' : 'entry-btn-disabled'\n\n\t\treturn (\n\t\t\t<div className={`entry-view ${isWOD ? 'wod-view' : 'non-wod-view'}`}>\n\t\t\t\t{entry !== ''\n\t\t\t\t\t?   <div>\n\t\t\t\t\t\t\t{isWOD &&\n\t\t\t\t\t\t\t\t<div className='center-div'>\n\t\t\t\t\t\t\t\t\t<h2 className='wod-date'>{new Date(entry.date).toLocaleDateString('en-US', {weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'})}\n\t\t\t\t\t\t\t\t\t</h2>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t<div className='inner-entry-view'>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<div className='entry-btn-container'>\n\t\t\t\t\t\t\t\t\t<button \n\t\t\t\t\t\t\t\t\t\tclassName='entry-btn entry-btn-active' \n\t\t\t\t\t\t\t\t\t\tonClick={() => this.toggleFavorite(entry_id, userID, canto_word)}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{isFavorited\n\t\t\t\t\t\t\t\t\t\t\t?\t<Icon \n\t\t\t\t\t\t\t\t\t\t\t\t\ticon='like-2-full' \n\t\t\t\t\t\t\t\t\t\t\t\t\ticonSize='35'\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolor='cantoPink'\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t:   <Icon \n\t\t\t\t\t\t\t\t\t\t\t\t\ticon='like-2' \n\t\t\t\t\t\t\t\t\t\t\t\t\ticonSize='35'\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolor='cantoDarkBlue'\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t<button \n\t\t\t\t\t\t\t\t\t\tclassName={`entry-btn ${active}`}\n\t\t\t\t\t\t\t\t\t\tonClick={this.playAudio}\n\t\t\t\t\t\t\t\t\t\tref={this.playButton}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<Icon \n\t\t\t\t\t\t\t\t\t\t\ticon='speaker-5' \n\t\t\t\t\t\t\t\t\t\t\ticonSize='35' \n\t\t\t\t\t\t\t\t\t\t\tcolor={audioAvailable\n\t\t\t\t\t\t\t\t\t\t\t\t? 'cantoDarkBlue'\n\t\t\t\t\t\t\t\t\t\t\t\t: 'cantoDarkGray'\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className='top-group entry-section'>\n\t\t\t\t\t\t\t\t\t<div className='canto-class'>\n\t\t\t\t\t\t\t\t\t\t<h3>{canto_word}</h3>\n\t\t\t\t\t\t\t\t\t\t<p>{clLabel}{classifier}</p>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div><p>{jyutping}</p></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className='entry-section'>\n\t\t\t\t\t\t\t\t\t<div><p>En: {english_word}</p></div>\n\t\t\t\t\t\t\t\t\t<div><p>普: {mandarin_word}</p></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className='entry-section'>\n\t\t\t\t\t\t\t\t\t<div><p>{canto_sentence}</p></div>\n\t\t\t\t\t\t\t\t\t<div><p>{jyutping_sentence}</p></div>\n\t\t\t\t\t\t\t\t\t<div><p>{english_sentence}</p></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t:   <div className='inner-entry-view'>\n\t\t\t\t\t\t\t<div className='entry-btn-container'>\n\t\t\t\t\t\t\t\t<div className='ghost-div'>&nbsp;</div>\n\t\t\t\t\t\t\t\t<div className='ghost-div'>&nbsp;</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className='top-group entry-section'>\n\t\t\t\t\t\t\t\t<div className='canto-class'>\n\t\t\t\t\t\t\t\t\t<div className='ghost-div'>&nbsp;</div>\n\t\t\t\t\t\t\t\t\t<div className='ghost-div'>&nbsp;</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<div className='ghost-div'>&nbsp;</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className='entry-section'>\n\t\t\t\t\t\t\t\t<div className='ghost-div'>&nbsp;</div>\n\t\t\t\t\t\t\t\t<div className='ghost-div'>&nbsp;</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className='entry-section'>\n\t\t\t\t\t\t\t\t<div className='ghost-div'>&nbsp;</div>\n\t\t\t\t\t\t\t\t<div className='ghost-div'>&nbsp;</div>\n\t\t\t\t\t\t\t\t<div className='ghost-div'>&nbsp;</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>}\n\n\t\t\t</div>\n\t\t\t\n\t\t);\n\t}\n\t\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(EntryView);"]},"metadata":{},"sourceType":"module"}