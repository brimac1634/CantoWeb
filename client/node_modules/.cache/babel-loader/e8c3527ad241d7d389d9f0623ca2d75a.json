{"ast":null,"code":"import _classCallCheck from \"/Users/brianmacpherson/Desktop/cantotalkweb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/brianmacpherson/Desktop/cantotalkweb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/brianmacpherson/Desktop/cantotalkweb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/brianmacpherson/Desktop/cantotalkweb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/brianmacpherson/Desktop/cantotalkweb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/brianmacpherson/Desktop/cantotalkweb/src/Components/SearchBar/SearchBar.js\";\nimport React, { Component } from 'react';\nimport './SearchBar.css';\nimport { connect } from 'react-redux';\nimport { push } from 'connected-react-router';\nimport { validateUser, setQueryURL, requestToLogin } from '../../Helpers/helpers';\nimport MediaQuery from 'react-responsive';\nimport queryString from 'query-string';\nimport TextInput from '../TextInput/TextInput';\nimport Button from '../Button/Button';\nimport { setPrevRoute as _setPrevRoute } from '../../Routing/actions';\nimport { setTempSearch as _setTempSearch, setSearchType as _setSearchType } from './actions';\nimport { routes } from '../../Routing/constants';\nimport Controller from '../../Helpers/Compound/Controller';\nimport Trigger from '../../Helpers/Compound/Trigger';\nimport DropDown from '../../Containers/DropDown/DropDown';\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    pathName: state.router.location.pathname,\n    hash: state.router.location.hash,\n    search: state.router.location.search,\n    userID: state.user.user.userID,\n    urlSearchKey: state.temp.key,\n    searchType: state.temp.searchType\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    updateURL: function updateURL(type) {\n      return dispatch(push(type));\n    },\n    setPrevRoute: function setPrevRoute(prevRoute) {\n      return dispatch(_setPrevRoute(prevRoute));\n    },\n    setTempSearch: function setTempSearch(key) {\n      return dispatch(_setTempSearch(key));\n    },\n    setSearchType: function setSearchType(type) {\n      return dispatch(_setSearchType(type));\n    }\n  };\n};\n\nvar SearchBar =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(SearchBar, _Component);\n\n  function SearchBar(props) {\n    var _this;\n\n    _classCallCheck(this, SearchBar);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(SearchBar).call(this, props));\n\n    _this.handleSearchRoute = function (e, route) {\n      var _this$props = _this.props,\n          pathName = _this$props.pathName,\n          updateURL = _this$props.updateURL,\n          userID = _this$props.userID;\n      var SEARCH = routes.SEARCH,\n          LOGIN = routes.LOGIN;\n      e.target.blur();\n\n      if (route === pathName) {\n        updateURL(SEARCH);\n      } else {\n        if (route !== SEARCH && !validateUser(userID)) {\n          requestToLogin(function () {\n            _setPrevRoute(pathName);\n\n            updateURL(LOGIN);\n          });\n        } else {\n          updateURL(route);\n        }\n      }\n    };\n\n    _this.handleSearch = function (word) {\n      var _this$props2 = _this.props,\n          updateURL = _this$props2.updateURL,\n          hash = _this$props2.hash,\n          searchType = _this$props2.searchType;\n      var url = setQueryURL(word, searchType, hash);\n      sessionStorage.setItem('searchURL', JSON.stringify(url));\n      updateURL(url);\n\n      _this.updateSearchList(word);\n    };\n\n    _this.searchChange = function (event) {\n      var word = event.target.value;\n      var initialSearchList = _this.state.initialSearchList;\n\n      _this.setState({\n        tempSearchKey: word\n      });\n\n      if (initialSearchList) {\n        var searchList = initialSearchList.filter(function (item) {\n          return item.includes(word);\n        });\n\n        _this.setState({\n          searchList: searchList\n        });\n      }\n    };\n\n    _this.searchSubmit = function (event) {\n      var hash = _this.props.hash;\n      var tempSearchKey = _this.state.tempSearchKey;\n      var enterPressed = event.which === 13;\n\n      if (enterPressed && tempSearchKey) {\n        event.target.blur();\n\n        _this.handleSearch(tempSearchKey, hash);\n      }\n    };\n\n    _this.updateSearchList = function (key) {\n      var searchList = JSON.parse(localStorage.getItem('searchList'));\n\n      if (searchList !== null) {\n        searchList.unshift(key);\n\n        if (searchList.length > 15) {\n          searchList.pop();\n        }\n\n        var i = searchList.length;\n\n        while (i--) {\n          if (searchList[i] === key && i !== 0) {\n            searchList.splice(i, 1);\n          }\n        }\n      } else {\n        searchList = [key];\n      }\n\n      _this.setState({\n        searchList: searchList,\n        initialSearchList: searchList\n      });\n\n      localStorage.setItem('searchList', JSON.stringify(searchList));\n    };\n\n    _this.wordSelect = function (word) {\n      var setTempSearch = _this.props.setTempSearch;\n      setTempSearch(word);\n\n      _this.handleSearch(word);\n    };\n\n    _this.state = {\n      tempSearchKey: '',\n      initialSearchList: [],\n      searchList: []\n    };\n    return _this;\n  }\n\n  _createClass(SearchBar, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this$props3 = this.props,\n          search = _this$props3.search,\n          setSearchType = _this$props3.setSearchType;\n      var searchList = JSON.parse(localStorage.getItem('searchList'));\n      this.setState({\n        initialSearchList: searchList,\n        searchList: searchList\n      });\n\n      if (search) {\n        var values = queryString.parse(search);\n        setSearchType(values.searchtype);\n      }\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      var urlSearchKey = this.props.urlSearchKey;\n\n      if (prevProps.urlSearchKey !== urlSearchKey) {\n        this.setState({\n          tempSearchKey: urlSearchKey\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props4 = this.props,\n          pathName = _this$props4.pathName,\n          searchType = _this$props4.searchType,\n          setSearchType = _this$props4.setSearchType;\n      var _this$state = this.state,\n          searchList = _this$state.searchList,\n          tempSearchKey = _this$state.tempSearchKey;\n      var FAVORITES = routes.FAVORITES,\n          RECENT = routes.RECENT;\n      var searchOptions = ['All', 'Can', 'Eng', 'Man', 'Jyu'];\n      return React.createElement(MediaQuery, {\n        maxWidth: 574,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, function (matches) {\n        return React.createElement(\"div\", {\n          className: \"search-bar-container\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 156\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"search-bar\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 157\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"filter-container\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 158\n          },\n          __self: this\n        }, React.createElement(Button, {\n          title: matches ? null : 'Recent',\n          buttonType: \"ghost\",\n          icon: \"time\",\n          height: matches ? '44px' : '34px',\n          iconSize: matches ? '22' : null,\n          margin: \"10px 5px 10px 10px\",\n          isSelected: pathName === RECENT ? true : false,\n          handleClick: function handleClick(e) {\n            return _this2.handleSearchRoute(e, RECENT);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 159\n          },\n          __self: this\n        }), React.createElement(Button, {\n          title: matches ? null : 'Favorites',\n          buttonType: \"ghost\",\n          icon: \"like-2\",\n          height: matches ? '44px' : '34px',\n          iconSize: matches ? '22' : null,\n          margin: \"10px 5px\",\n          isSelected: pathName === FAVORITES ? true : false,\n          handleClick: function handleClick(e) {\n            return _this2.handleSearchRoute(e, FAVORITES);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 171\n          },\n          __self: this\n        })), React.createElement(\"div\", {\n          className: \"search-container\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 184\n          },\n          __self: this\n        }, pathName === RECENT || pathName === FAVORITES ? null : React.createElement(Controller, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 187\n          },\n          __self: this\n        }, React.createElement(Trigger, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 188\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"center-div\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 189\n          },\n          __self: this\n        }, React.createElement(TextInput, {\n          button: searchType,\n          buttonList: searchOptions,\n          handleDropDown: function handleDropDown(type) {\n            return setSearchType(type);\n          },\n          placeHolder: \"English/Cantonese/Mandarin/Jyutping\",\n          margin: \"10px 0\",\n          value: tempSearchKey ? tempSearchKey : '',\n          height: matches ? '44px' : '34px',\n          padding: \"2px 5px 2px 2px\",\n          handleChange: _this2.searchChange,\n          handleInput: _this2.searchSubmit,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 190\n          },\n          __self: this\n        }))), React.createElement(DropDown, {\n          list: searchList,\n          handleSelection: _this2.wordSelect,\n          adjustY: -5,\n          maxHeight: \"200px\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 204\n          },\n          __self: this\n        })))));\n      });\n    }\n  }]);\n\n  return SearchBar;\n}(Component);\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SearchBar);","map":{"version":3,"sources":["/Users/brianmacpherson/Desktop/cantotalkweb/src/Components/SearchBar/SearchBar.js"],"names":["React","Component","connect","push","validateUser","setQueryURL","requestToLogin","MediaQuery","queryString","TextInput","Button","setPrevRoute","setTempSearch","setSearchType","routes","Controller","Trigger","DropDown","mapStateToProps","state","pathName","router","location","pathname","hash","search","userID","user","urlSearchKey","temp","key","searchType","mapDispatchToProps","dispatch","updateURL","type","prevRoute","SearchBar","props","handleSearchRoute","e","route","SEARCH","LOGIN","target","blur","handleSearch","word","url","sessionStorage","setItem","JSON","stringify","updateSearchList","searchChange","event","value","initialSearchList","setState","tempSearchKey","searchList","filter","item","includes","searchSubmit","enterPressed","which","parse","localStorage","getItem","unshift","length","pop","i","splice","wordSelect","values","searchtype","prevProps","FAVORITES","RECENT","searchOptions","matches"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport './SearchBar.css';\nimport { connect } from 'react-redux';\nimport { push } from 'connected-react-router'\nimport { validateUser, setQueryURL, requestToLogin } from '../../Helpers/helpers';\nimport MediaQuery from 'react-responsive';\nimport queryString from 'query-string';\nimport TextInput from '../TextInput/TextInput';\nimport Button from '../Button/Button';\nimport { setPrevRoute } from '../../Routing/actions';\nimport { setTempSearch, setSearchType } from './actions';\nimport { routes } from '../../Routing/constants';\nimport Controller from '../../Helpers/Compound/Controller';\nimport Trigger from '../../Helpers/Compound/Trigger';\nimport DropDown from '../../Containers/DropDown/DropDown';\n\nconst mapStateToProps = state => {\n\treturn {\n\t\tpathName: state.router.location.pathname,\n\t\thash: state.router.location.hash,\n\t\tsearch: state.router.location.search,\n\t\tuserID: state.user.user.userID,\n\t\turlSearchKey: state.temp.key,\n\t\tsearchType: state.temp.searchType,\n\t}\n}\n\nconst mapDispatchToProps = (dispatch) => {\n\treturn {\n\t\tupdateURL: (type) => dispatch(push(type)),\n\t\tsetPrevRoute: (prevRoute) => dispatch(setPrevRoute(prevRoute)),\n\t\tsetTempSearch: (key) => dispatch(setTempSearch(key)),\n\t\tsetSearchType: (type) => dispatch(setSearchType(type)),\n\t}\n}\n\nclass SearchBar extends Component {\n\tconstructor(props) {\n\t\tsuper(props)\n\t\tthis.state = {\n\t\t\ttempSearchKey: '',\n\t\t\tinitialSearchList: [],\n\t\t\tsearchList: [],\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tconst { search, setSearchType } = this.props;\n\t\tconst searchList = JSON.parse(localStorage.getItem('searchList'))\n\t\tthis.setState({\n\t\t\tinitialSearchList: searchList,\n\t\t\tsearchList\n\t\t})\n\n\t\tif (search) {\n\t\t\tconst values = queryString.parse(search)\n\t\t\tsetSearchType(values.searchtype)\n\t\t} \n\t}\n\n\tcomponentDidUpdate(prevProps) {\n\t\tconst { urlSearchKey } = this.props;\n\t\tif (prevProps.urlSearchKey !== urlSearchKey) {\n\t\t\tthis.setState({tempSearchKey: urlSearchKey})\n\t\t}\n\t}\n\n\thandleSearchRoute = (e, route) => {\n\t\tconst { pathName, updateURL, userID } = this.props;\n\t\tconst { SEARCH, LOGIN } = routes;\n\t\te.target.blur();\n\t\tif (route === pathName) {\n\t\t\tupdateURL(SEARCH)\n\t\t} else {\n\t\t\tif (route !== SEARCH && !validateUser(userID)) {\n\t\t\t\trequestToLogin(()=>{\n\t\t\t\t\tsetPrevRoute(pathName)\n\t\t        \tupdateURL(LOGIN)\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tupdateURL(route)\n\t\t\t}\n\t\t}\n\t}\n\n\thandleSearch = (word) => {\n\t\tconst { updateURL, hash, searchType } = this.props;\n\t\tconst url = setQueryURL(word, searchType, hash)\n\t\tsessionStorage.setItem('searchURL', JSON.stringify(url));\n\t\tupdateURL(url)\n\t\tthis.updateSearchList(word);\n\t}\n\n\tsearchChange = (event) => {\n\t\tconst word = event.target.value\n\t\tlet { initialSearchList } = this.state;\n\t\tthis.setState({tempSearchKey: word})\n\t\tif (initialSearchList) {\n\t\t\tconst searchList = initialSearchList.filter(item => item.includes(word))\n\t\t\tthis.setState({searchList})\n\t\t}\n\t}\n\n\tsearchSubmit = (event) => {\n\t\tconst { hash } = this.props;\n\t\tconst { tempSearchKey } = this.state;\n\t\tconst enterPressed = (event.which === 13);\n\t\tif (enterPressed && tempSearchKey) {\n\t\t\tevent.target.blur();\n\t\t\tthis.handleSearch(tempSearchKey, hash)\n\t\t}\n\t}\n\n\tupdateSearchList = (key) => {\n\t\tlet searchList = JSON.parse(localStorage.getItem('searchList'))\n\t\tif (searchList !== null) {\n\t\t\tsearchList.unshift(key)\n\t\t\tif (searchList.length > 15) {\n\t\t\t\tsearchList.pop()\n\t\t\t}\n\t\t\tlet i = searchList.length\n\t\t\twhile (i--) {\n\t\t\t\tif (searchList[i] === key && i !== 0) {\n\t\t\t\t\tsearchList.splice(i, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tsearchList = [key]\n\t\t}\n\t\tthis.setState({\n\t\t\tsearchList,\n\t\t\tinitialSearchList: searchList,\n\t\t})\n\t\tlocalStorage.setItem('searchList', JSON.stringify(searchList))\n\t}\n\n\twordSelect = (word) => {\n\t\tconst { setTempSearch } = this.props;\n\t\tsetTempSearch(word)\n\t\tthis.handleSearch(word)\n\t}\n\t\n\trender() {\n\t\tconst { \n\t\t\tpathName,\n\t\t\tsearchType,\n\t\t\tsetSearchType\n\t\t } = this.props;\n\t\t const { searchList, tempSearchKey } = this.state;\n\t\t const { FAVORITES, RECENT } = routes;\n\t\t const searchOptions = ['All', 'Can', 'Eng', 'Man', 'Jyu'];\n\t\treturn (\n\t\t\t<MediaQuery maxWidth={574}>\n\t\t\t\t{(matches) => {\n\t\t\t\treturn (\n\t\t\t\t\t<div className='search-bar-container'>\n\t\t\t\t\t\t<div className='search-bar'>\n\t\t\t\t\t\t\t<div className='filter-container'>\n\t\t\t\t\t\t\t\t<Button \n\t\t\t\t\t\t\t\t\ttitle={matches ? null : 'Recent'}\n\t\t\t\t\t\t\t\t\tbuttonType='ghost' \n\t\t\t\t\t\t\t\t\ticon='time' \n\t\t\t\t\t\t\t\t\theight={matches ? '44px' : '34px'}\n\t\t\t\t\t\t\t\t\ticonSize={matches ? '22' : null}\n\t\t\t\t\t\t\t\t\tmargin='10px 5px 10px 10px'\n\t\t\t\t\t\t\t\t\tisSelected={pathName === RECENT\n\t\t\t\t\t\t\t\t\t\t\t\t\t? true\n\t\t\t\t\t\t\t\t\t\t\t\t\t: false}\n\t\t\t\t\t\t\t\t\thandleClick={e=>this.handleSearchRoute(e, RECENT)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<Button \n\t\t\t\t\t\t\t\t\ttitle={matches ? null : 'Favorites'}\n\t\t\t\t\t\t\t\t\tbuttonType='ghost' \n\t\t\t\t\t\t\t\t\ticon='like-2' \n\t\t\t\t\t\t\t\t\theight={matches ? '44px' : '34px'}\n\t\t\t\t\t\t\t\t\ticonSize={matches ? '22' : null}\n\t\t\t\t\t\t\t\t\tmargin='10px 5px'\n\t\t\t\t\t\t\t\t\tisSelected={pathName === FAVORITES\n\t\t\t\t\t\t\t\t\t\t\t\t\t? true\n\t\t\t\t\t\t\t\t\t\t\t\t\t: false}\n\t\t\t\t\t\t\t\t\thandleClick={e=>this.handleSearchRoute(e, FAVORITES)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className='search-container'>\n\t\t\t\t\t\t\t\t{pathName === RECENT || pathName === FAVORITES\n\t\t\t\t\t\t\t\t\t?\tnull\n\t\t\t\t\t\t\t\t\t:   <Controller>\n\t\t\t\t\t\t\t\t\t\t\t<Trigger>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className='center-div'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<TextInput  \n\t\t\t\t\t\t\t\t\t\t\t\t\t\tbutton={searchType}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tbuttonList={searchOptions}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\thandleDropDown={type=>setSearchType(type)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceHolder='English/Cantonese/Mandarin/Jyutping'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tmargin='10px 0'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={tempSearchKey ? tempSearchKey : ''}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\theight={matches ? '44px' : '34px'} \n\t\t\t\t\t\t\t\t\t\t\t\t\t\tpadding='2px 5px 2px 2px'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\thandleChange={this.searchChange}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\thandleInput={this.searchSubmit}\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</Trigger>\n\t\t\t\t\t\t\t\t\t\t\t<DropDown \n\t\t\t\t\t\t\t\t\t\t\t\tlist={searchList} \n\t\t\t\t\t\t\t\t\t\t\t\thandleSelection={this.wordSelect}\n\t\t\t\t\t\t\t\t\t\t\t\tadjustY={-5}\n\t\t\t\t\t\t\t\t\t\t\t\tmaxHeight='200px'\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</Controller>\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t)}}\n\t\t\t</MediaQuery>\n\t\t);\n\t}\n\t\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SearchBar);"]},"metadata":{},"sourceType":"module"}